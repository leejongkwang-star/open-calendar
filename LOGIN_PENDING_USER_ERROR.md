# ìŠ¹ì¸ ëŒ€ê¸° ì‚¬ìš©ì ë¡œê·¸ì¸ 403 ì˜¤ë¥˜ ë¶„ì„

## ğŸ”´ ë¬¸ì œ ìƒí™©

- ìŠ¹ì¸ ìš”ì²­í•œ ì§ì›ì´ ì•„ì§ ê´€ë¦¬ì ìŠ¹ì¸ ì „ ìƒíƒœ
- ë¡œê·¸ì¸ ì‹œ "Request failed with status code 403" ì˜¤ë¥˜ ë°œìƒ
- ì‚¬ìš©ìì—ê²Œ ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

## ğŸ“‹ ì½”ë“œ ë¶„ì„

### ë°±ì—”ë“œ ë¡œê·¸ì¸ API (`backend/src/routes/auth.js`)

**175-188ì¤„:**
```javascript
if (user.status === 'PENDING') {
  return res.status(403).json({
    message: 'ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ìŠ¹ì¸ í›„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
  })
}

if (user.status === 'REJECTED') {
  return res.status(403).json({
    message: 'ê³„ì •ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.',
  })
}

if (user.status !== 'APPROVED') {
  return res.status(403).json({
    message: 'ê³„ì • ìƒíƒœê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.',
  })
}
```

**ë¶„ì„:**
- âœ… ë°±ì—”ë“œëŠ” ìŠ¹ì¸ ëŒ€ê¸° ì‚¬ìš©ìì—ê²Œ 403ê³¼ í•¨ê»˜ ëª…í™•í•œ ë©”ì‹œì§€ë¥¼ ë°˜í™˜
- âœ… ë©”ì‹œì§€: "ê´€ë¦¬ì ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ìŠ¹ì¸ í›„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."

### í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ì¸ ì²˜ë¦¬ (`frontend/src/pages/LoginPage.jsx`)

**43-44ì¤„:**
```javascript
} catch (err) {
  setError(err.message || err.response?.data?.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì›ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.')
}
```

**ë¬¸ì œ:**
- âœ… `err.response?.data?.message`ë¥¼ í™•ì¸í•˜ë¯€ë¡œ ë°±ì—”ë“œ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ì–´ì•¼ í•¨
- âš ï¸ í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” "Request failed with status code 403"ë§Œ í‘œì‹œë¨
- âš ï¸ ì´ëŠ” Axiosê°€ ì—ëŸ¬ ì‘ë‹µì„ ì œëŒ€ë¡œ íŒŒì‹±í•˜ì§€ ëª»í•˜ê±°ë‚˜, ì—ëŸ¬ ê°ì²´ êµ¬ì¡°ê°€ ì˜ˆìƒê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ

## ğŸ” ê°€ëŠ¥í•œ ì›ì¸

### ì›ì¸ 1: Axios ì—ëŸ¬ ì‘ë‹µ ì²˜ë¦¬ ë¬¸ì œ

**Axios ì‘ë‹µ ì¸í„°ì…‰í„° (`frontend/src/utils/api.js`):**
```javascript
api.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      // ì¸ì¦ ì‹¤íŒ¨ ì‹œ ë¡œê·¸ì•„ì›ƒ
      localStorage.removeItem('auth-storage')
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)
```

**ë¶„ì„:**
- 401ë§Œ ì²˜ë¦¬í•˜ê³  403ì€ ì²˜ë¦¬í•˜ì§€ ì•ŠìŒ
- ì—ëŸ¬ëŠ” ê·¸ëŒ€ë¡œ ì „ë‹¬ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ì´ê²ƒ ìì²´ëŠ” ë¬¸ì œê°€ ì•„ë‹˜

### ì›ì¸ 2: ì—ëŸ¬ ë©”ì‹œì§€ ì¶”ì¶œ ë¬¸ì œ

**í˜„ì¬ ì½”ë“œ:**
```javascript
setError(err.message || err.response?.data?.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤...')
```

**ë¬¸ì œ:**
- `err.message`ê°€ ë¨¼ì € ì²´í¬ë¨
- Axios ì—ëŸ¬ì˜ ê²½ìš° `err.message`ëŠ” "Request failed with status code 403"ì¼ ìˆ˜ ìˆìŒ
- ë”°ë¼ì„œ `err.response?.data?.message`ê°€ ìˆì–´ë„ ë¬´ì‹œë  ìˆ˜ ìˆìŒ

## âœ… í•´ê²° ë°©ë²•

### ë°©ë²• 1: ì—ëŸ¬ ë©”ì‹œì§€ ìš°ì„ ìˆœìœ„ ìˆ˜ì • (ê¶Œì¥)

**ìˆ˜ì • ì „:**
```javascript
setError(err.message || err.response?.data?.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤...')
```

**ìˆ˜ì • í›„:**
```javascript
setError(err.response?.data?.message || err.message || 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤...')
```

**ì´ìœ :**
- ë°±ì—”ë“œì—ì„œ ë°˜í™˜í•œ êµ¬ì²´ì ì¸ ë©”ì‹œì§€ë¥¼ ìš°ì„  í‘œì‹œ
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë“± `err.response`ê°€ ì—†ëŠ” ê²½ìš°ì—ë§Œ `err.message` ì‚¬ìš©

### ë°©ë²• 2: 403 ìƒíƒœë³„ ì»¤ìŠ¤í…€ ë©”ì‹œì§€

```javascript
} catch (err) {
  let errorMessage = 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì§ì›ë²ˆí˜¸ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.'
  
  if (err.response?.status === 403) {
    // 403 ì˜¤ë¥˜: ë°±ì—”ë“œ ë©”ì‹œì§€ ìš°ì„  ì‚¬ìš©
    errorMessage = err.response?.data?.message || 'ì ‘ê·¼ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.'
  } else if (err.response?.status === 404) {
    errorMessage = 'í•´ë‹¹ ì§ì›ë²ˆí˜¸ë¥¼ ê°€ì§„ ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'
  } else if (err.response?.data?.message) {
    errorMessage = err.response.data.message
  } else if (err.message) {
    errorMessage = err.message
  }
  
  setError(errorMessage)
}
```

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ë°±ì—”ë“œê°€ ì˜¬ë°”ë¥¸ ë©”ì‹œì§€ë¥¼ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ ìˆ˜ì •
- [ ] í…ŒìŠ¤íŠ¸: ìŠ¹ì¸ ëŒ€ê¸° ì‚¬ìš©ì ë¡œê·¸ì¸ ì‹œë„
- [ ] ëª…í™•í•œ ì•ˆë‚´ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

---

**í•µì‹¬ ë¬¸ì œ: í”„ë¡ íŠ¸ì—”ë“œì—ì„œ `err.message`ë¥¼ `err.response?.data?.message`ë³´ë‹¤ ë¨¼ì € ì²´í¬í•˜ì—¬, Axiosì˜ ê¸°ë³¸ ì—ëŸ¬ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ê³  ìˆìŠµë‹ˆë‹¤.**

